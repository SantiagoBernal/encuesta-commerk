"use strict";(self.webpackChunkstarter_bt5=self.webpackChunkstarter_bt5||[]).push([[57],{9057:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var r=n(2327),s=n(9157),a=n(1906),c=n(5043),l=n(7642),o=n(4329),i=n(7539),d=n(1238),h=n(4535),u=n(7154),g=n(547),x=n(490),p=n(7600),j=n(6494),f=n(5865),A=n(579);const v=(0,h.Ay)("div")((e=>{let{theme:t}=e;return{...t.typography.button,backgroundColor:t.palette.background.paper,padding:t.spacing(0)}})),y=["xlsx","xls","csv"],b=()=>{const[e,t]=(0,c.useState)([]),[n,h]=(0,c.useState)(!1),b=c.useRef(null);return(0,A.jsx)(r.A,{children:(0,A.jsxs)(s.A,{sx:{maxWidth:345},children:[(0,A.jsxs)(j.A,{children:[(0,A.jsx)(f.A,{gutterBottom:!0,variant:"h5",component:"div",children:(0,A.jsxs)(v,{children:[e&&e.length>0?"Se cargaron ":"Cargar "," ",(0,A.jsxs)("b",{children:["  ",e&&e.length>0?e.length:"","  "]}),"  "," Clientes"]})}),(0,A.jsx)(f.A,{variant:"body2",color:"text.secondary",children:"Seleccione un archivo de Excel para cargar los clientes."})]}),(0,A.jsx)(p.A,{children:(0,A.jsx)("div",{className:"button-group",children:(0,A.jsxs)("label",{children:[(0,A.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{const r=e.target.files[0],s=new FileReader;s.onload=e=>{const n=e.target.result,r=d.LF(n,{type:"binary"}),s=r.SheetNames[0],a=r.Sheets[s],c=d.Wp.sheet_to_json(a,{header:1}),l=c[0];c.splice(0,1);const o=((e,t)=>{const n=[];return t.forEach((t=>{let r={};t.forEach(((t,n)=>{r[e[n]]=t})),n.push(r)})),n})(l,c),i=[];if(o.length>0){for(let e=0;e<o.length;e++){o[e].telefono_1||(o[e].telefono_1="0"),o[e].telefono_2||(o[e].telefono_2="0");const t=!1;o[e].estado_encuesta=t,i.push(o[e])}t(o)}},r&&((e=>{const t=e.name.split("."),n=t[t.length-1];return y.includes(n)})(r)?s.readAsBinaryString(r):n("Invalid file input, Select Excel, CSV file"))},ref:b}),(0,A.jsxs)(l.A,{alignContent:"contained",direction:"row",spacing:5,children:[(0,A.jsx)(a.A,{onClick:e=>{b.current.click()},variant:"outlined",size:"large",startIcon:(0,A.jsx)(i.A,{}),children:"Cargar"}),(0,A.jsx)(a.A,{onClick:async n=>{n.preventDefault();for(let s=0;s<e.length;s++)try{200===(await u.A.post("".concat("https://encuesta-commerk.onrender.com","/cliente/nuevo"),e[s])).status&&(h(!0),t([]))}catch(r){console.error("Error creating post:",r)}},variant:"contained",size:"large",endIcon:(0,A.jsx)(o.A,{}),children:"Guardar"})]})]})})}),n?(0,A.jsx)(l.A,{sx:{width:"100%"},spacing:2,children:(0,A.jsxs)(g.A,{severity:"success",children:[(0,A.jsx)(x.A,{children:"Exito!"}),"Se guardaron los clientes correctamente."]})}):(0,A.jsx)(A.Fragment,{})]})})}}}]);
//# sourceMappingURL=57.b3060883.chunk.js.map